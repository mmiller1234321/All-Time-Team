<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All Time Team</title>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<style>
  body {
    background-color: #71A95A; /* Green like Wrigley Field grass */
    font-family: Arial, sans-serif;
  }
  .container {
    margin-top: 20px;
    background-color: #FAFAD2; /* Sand color */
    padding: 20px;
    border-radius: 10px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background-color: #FAFAD2; /* Sand color */
  }
  th, td {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
  }
  th {
    background-color: #f2f2f2; /* Light gray header */
  }
  .stat-square {
    width: 30px;
    height: 30px;
    background-color: #ffffff; /* White square */
    border: 1px solid #dddddd;
  }
</style>
</head>
<body>

<div class="container">
  <h2>All Time Teams</h2>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th id="teamLabel"></th>
        <th>Position</th>
        <th id="statLabel">Stat</th> <!-- New column for Stat -->
        <th>Submit Player</th> <!-- New column for submit button -->
      </tr>
    </thead>
    <tbody id="playerRows">
      <!-- Table rows will be generated dynamically -->
    </tbody>
  </table>
</div>

<script>
function updateLabels() {
  var teams = [
    "Arizona Diamondbacks", "Atlanta Braves", "Baltimore Orioles", "Boston Red Sox",
    "Chicago White Sox", "Chicago Cubs", "Cincinnati Reds", "Cleveland Guardians",
    "Colorado Rockies", "Detroit Tigers", "Houston Astros", "Kansas City Royals",
    "Los Angeles Angels of Anaheim", "Los Angeles Dodgers", "Miami Marlins", "Milwaukee Brewers",
    "Minnesota Twins", "New York Yankees", "New York Mets", "Oakland Athletics",
    "Philadelphia Phillies", "Pittsburgh Pirates", "San Diego Padres", "San Francisco Giants",
    "Seattle Mariners", "St. Louis Cardinals", "Tampa Bay Rays", "Texas Rangers",
    "Toronto Blue Jays", "Washington Nationals"
  ];
  var randomTeamIndex = Math.floor(Math.random() * teams.length);
  var randomTeam = teams[randomTeamIndex];
  document.getElementById('teamLabel').innerText = randomTeam;

  var stats = ["r", "h", "2b", "3b", "hr", "rbi", "sb", "bb", "ibb"];
  var randomStatIndex = Math.floor(Math.random() * stats.length);
  var randomStat = stats[randomStatIndex];
  document.getElementById('statLabel').innerText = randomStat;
}

function handleSubmit(event) {
  var playerName = event.target.parentElement.parentElement.children[0].children[0].value;
  var position = event.target.parentElement.parentElement.children[1].textContent;
  var team = document.getElementById('teamLabel').textContent;
  var stat = document.getElementById('statLabel').textContent; // Retrieve the value of the stats label

  var xhr = new XMLHttpRequest();
  xhr.open('GET', 'http://localhost:3000/search?playerName=' + playerName + '&position=' + position + '&team=' + team + '&stat=' + stat, true);
  xhr.onload = function () {
    if (xhr.status === 200) {
      var statSquare = event.target.parentElement.parentElement.children[2].children[0];
      var statValue = xhr.responseText;
      statSquare.textContent = (statValue === '0') ? '0' : statValue; // Display '0' if no data found
    } else {
      console.error('Error fetching data:', xhr.statusText);
    }
  };
  xhr.onerror = function () {
    console.error('Error fetching data.');
  };
  xhr.send();
}

function addPlayerRows() {
  var positions = ["C", "1B", "2B", "3B", "SS", "OF", "OF", "OF", "P"];
  var tbody = document.getElementById("playerRows");
  for (var i = 0; i < 10; i++) {
    var row = document.createElement("tr");
    
    var playerNameCell = document.createElement("td");
    var playerNameInput = document.createElement("input");
    playerNameInput.type = "text";
    playerNameInput.className = "form-control";
    playerNameInput.placeholder = "Enter player's name";
    playerNameCell.appendChild(playerNameInput);
    row.appendChild(playerNameCell);
    
    var positionCell = document.createElement("td");
    positionCell.textContent = positions[i];
    row.appendChild(positionCell);
    
    var statCell = document.createElement("td");
    var statSquare = document.createElement("div");
    statSquare.className = "stat-square";
    statCell.appendChild(statSquare);
    row.appendChild(statCell);
    
    var submitCell = document.createElement("td");
    var submitButton = document.createElement("button");
    submitButton.type = "button";
    submitButton.className = "btn btn-primary";
    submitButton.textContent = "Submit";
    submitButton.addEventListener('click', handleSubmit);
    submitCell.appendChild(submitButton);
    row.appendChild(submitCell);
    
    tbody.appendChild(row);
  }
}

window.onload = function() {
  updateLabels();
  addPlayerRows();
};
</script>

</body>
</html>
